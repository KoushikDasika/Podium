
<!-- Hide Safari Browser bar on iOS -->
<meta name="viewport" content="width=device-width, minimum-scale=1, maximum-scale=1">
<meta name="apple-mobile-web-app-capable" content="yes" />
<meta name="apple-mobile-web-app-status-bar-style" content="black" />
<link rel="apple-touch-icon" href="apple-touch-icon-57x57.png" />
<link rel="apple-touch-icon" sizes="72x72" href="apple-touch-icon-72x72.png" />
<link rel="apple-touch-icon" sizes="114x114" href="apple-touch-icon-114x114.png" />
<link rel="apple-touch-startup-image" href="apple-touch-startup-image-320x460.png" />
<link rel="apple-touch-startup-image" sizes="768x1004" href="apple-touch-startup-image-768x1004.png" />

<!-- Preloader -->
<div id="preloader">
  <div id="status">&nbsp;</div>
</div>
	
	<div id="myModal" class="reveal-modal" data-reveal>
	  <h2>Share your presentation:</h2>
	  <%= social_share_button_tag(@project.description, :url => request.original_url) %><br />

	  <%= form_for "#" do |f| %>
		  <%= f.label 'Link:' %>
		  <%= f.text_field '', :value => request.original_url, disabled: true %>
		<% end %>
	  <a class="close-reveal-modal">&#215;</a>
	</div>

	<div class="controls">
		<div class="vertical-menu">
			<i class='icon-code'></i>
		<%= link_to "<i class='icon-download'></i>".html_safe, project_path(@project, :format => "pdf") %>
			<a href="#" data-reveal-id="myModal"><i class='icon-share-alt'></i></a>
		</div>
		<div class='player'>
			<i class='icon-chevron-left'></i>
			
			<i class='icon-chevron-right'></i>
			<div class="expand"></div>
		</div>
	</div>



<div class='row' >
		<script>
			$(function(){
				$(document).on('dragstart', function(event) { event.preventDefault(); });

				$( document ).on( "swipeleft", swipeleftHandler );
	 			
			  // Callback function references the event target and adds the 'swipeleft' class to it
			  function swipeleftHandler( event ){
			  	$(".icon-chevron-right").click();
			   
			 	}
			});

			$(function(){
			  $( document ).on( "swiperight", swiperightHandler );
			 
			  // Callback function references the event target and adds the 'swipeleft' class to it
			  function swiperightHandler( event ){
			    $(".icon-chevron-left").click();
			  }
			});
		</script>

	<div>
		<!-- <a class="lines-icon"></a> -->
		<div id="pt-main" style="display:none; background-color: black;" class="pt-perspective">

			<% @project.slides.order("position").each do |slide| %>
				<div class="pt-page" data-transition="<%= @project.transition %>">
					<% if slide.mimetype == "video/mp4" %>
						<video width='100%' height='100%' autoplay="autoplay">
							<source src="<%= slide.filepicker_url %>">
						</video>
					<% else %>
						<% unless slide.filepicker_url.blank? %>
							<img src="<%= slide.filepicker_url %>/convert?w=1920&h=1080&fit=scale">
						<% else %>
							<div class="blank" id="slide-<%= slide.id -%>"></div>

							<% if slide.embed_code =~ /^#{URI::regexp}$/%>
						
								<script>
								$(document).ready(function() {
							    var pop = Popcorn.smart( "#slide-<%= slide.id -%>", "<%= slide.embed_code %>" );
							  
							     var playing = false;
							     $( "body" ).on( "change-slide", function() {
							    
							     	if($("#slide-<%= slide.id -%>").parent(".pt-page").hasClass('pt-page-current')) { 
							     		playing = true;
							     	 	pop.play(); //Autoplay on slide reveal.
								     } else {
								     	
								     	if(playing) { //pause and reset current time to 0 if you switch slides.
								     	  pop.pause();
								     	  pop.currentTime(0);
								     	  console.log("paused")
								     	  playing = false;
								     	}
								     }
							     });
							   });
								</script>
							<% end %>
						<% end %>
					<% end %>
				</div>
			<% end %>
		</div>
	</div>
</div>
 		
            <!-- Preloader -->
    <script type="text/javascript">
    //<![CDATA[
      $(window).load(function() { // makes sure the whole site is loaded

				$("#status").fadeOut(); // will first fade out the loading animation
				var opts = {
				lines: 13, // The number of lines to draw
				length: 1, // The length of each line
				width: 5, // The line thickness
				radius: 13, // The radius of the inner circle
				corners: 1, // Corner roundness (0..1)
				rotate: 0, // The rotation offset
				direction: 1, // 1: clockwise, -1: counterclockwise
				color: 'white', // #rgb or #rrggbb or array of colors
				speed: 1, // Rounds per second
				trail: 60, // Afterglow percentage
				shadow: false, // Whether to render a shadow
				hwaccel: false, // Whether to use hardware acceleration
				className: 'spinner', // The CSS class to assign to the spinner
				zIndex: 2e9, // The z-index (defaults to 2000000000)
				top: 'auto', // Top position relative to parent in px
				left: 'auto' // Left position relative to parent in px
				};
				var target = document.getElementById('status');
				var spinner = new Spinner(opts).spin(target);
				$("#preloader").delay(350).fadeOut("slow"); // will fade out the white DIV that covers the website.
				$("#pt-main").fadeIn('slow');
  
      })
    //]]>
    $(".top-bar").hide();
		</script>

		<script src="http://code.jquery.com/mobile/1.3.2/jquery.mobile-1.3.2.min.js"></script>




