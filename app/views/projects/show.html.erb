
<!-- Preloader -->
<div id="preloader">
  <div id="status">&nbsp;</div>
</div>

<div class="controls">
				<div class='player'>
					<i class='icon-chevron-left'></i>
					<i class='icon-play'></i>
					<i class='icon-chevron-right'></i>
					<div class="back"><input action="action" type="button" value="Back" onclick="history.go(-1);" /></div>
					<div class="vertical-menu">
						<i class='icon-code'></i>
						<i class='icon-download'></i>
						<i class='icon-share-alt'></i>
					</div>
					<div class="expand"></div>
				</div>
			</div>

<div class='row'>
	<div class='large-12 columns'>
		<!-- <a class="lines-icon"></a> -->
		<div id="pt-main" class="pt-perspective">

			<% @project.slides.order("position").each do |slide| %>
				<div class="pt-page" data-transition="<%= @project.transition %>">
					<% if slide.mimetype == "video/mp4" %>
						<video width='100%' height='100%'>
							<source src="<%= slide.filepicker_url %>">
						</video>
					<% else %>
						<% unless slide.filepicker_url.blank? %>
							<img src="<%= slide.filepicker_url %>/convert?w=1920&h=1080&fit=scale">
						<% else %>
							<div class="blank" id="slide-<%= slide.id -%>"></div>
							<script>
							$(document).ready(function() {
						    var pop = Popcorn.smart( "#slide-<%= slide.id -%>", "<%= slide.embed_code %>" );
						  
						     var playing = false;
						     $( "body" ).on( "change-slide", function() {
						    
						     	if($("#slide-<%= slide.id -%>").parent(".pt-page").hasClass('pt-page-current')) { 
						     		playing = true;
						     	 	pop.play(); //Autoplay on slide reveal.
							     } else {
							     	
							     	if(playing) { //pause and reset current time to 0 if you switch slides.
							     	  pop.pause();
							     	  pop.currentTime(0);
							     	  console.log("paused")
							     	  playing = false;
							     	}
							     }

						     });
						     
						   });
							</script>
						<% end %>
					<% end %>
				</div>
			<% end %>
		</div>
	</div>
</div>
 		
            <!-- Preloader -->
    <script type="text/javascript">
    //<![CDATA[
      $(window).load(function() { // makes sure the whole site is loaded
          $("#status").fadeOut(); // will first fade out the loading animation
          $("#preloader").delay(350).fadeOut("slow"); // will fade out the white DIV that covers the website.

      })
    //]]>
    $(".top-bar").hide();
		</script>


